[tool.cibuildwheel]
build = ["cp312-*"]
manylinux-x86_64-image = "manylinux2014"
skip = ["*musllinux*"]
environment = { CIBUILDWHEEL = "1" }
before-all = """
    git clone https://github.com/Restream/reindexer.git
    cd reindexer
    ./dependencies.sh
    mkdir -p build && cd build
    cmake ..
    make -j4
    make install
    cd ../..
    rm -rf reindexer/
"""

[tool.cibuildwheel.linux]
archs = ["auto64"]

[tool.cibuildwheel.macos]
archs = ["auto64"]

[build-system]
requires = [
    "setuptools",
    "wheel",
    "pybind11",
    "build"
]

build-backend = "setuptools.build_meta"